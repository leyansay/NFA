<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>NFA Rice Inventory â€” Transaction</title>
<link rel="stylesheet" href="css/transaction.css">

</head>

<body>
<div class="app">

  <!-- SIDEBAR -->
  <div id="sidebar"></div>

  <!-- ACCOUNTABLE OFFICER MODAL -->
  <div id="officerModal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeOfficer">&times;</span>
      <h2>Select Accountable Officer</h2>

      <table class="inventory-table">
        <thead>
          <tr>
            <th>Officer ID</th>
            <th>Last Name</th>
            <th>First Name</th>
            <th>Middle Name</th>
            <th>Warehouse Code</th>
            <th>Warehouse Name</th>
            <th>Period</th>
            <th>Select</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>Amoyan</td>
            <td>Mark Ray</td>
            <td>A</td>
            <td>112311</td>
            <td>GID 1</td>
            <td>2025-12-12 / 2026-02-24</td>
            <td><button class="selectOfficer">Select</button></td>
          </tr>
          <tr>
            <td>2</td>
            <td>Reyes</td>
            <td>Anna</td>
            <td>Marie</td>
            <td>112312</td>
            <td>GID 2</td>
            <td>2025-11-01 / 2026-01-31</td>
            <td><button class="selectOfficer">Select</button></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- TRANSACTION MODAL -->
  <div id="transactionModal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeTransaction">&times;</span>
      <h2>Add Transaction</h2>

      <form id="transactionForm">

        <h3>Accountability Information</h3>

        <!-- ACCOUNTABLE OFFICER -->
        <div class="grid">
          <div>
            <label>Accountable Officer ID</label>
            <input type="text" id="officerId" readonly>
          </div>
          <div>
            <label>Accountable Officer Name</label>
            <input type="text" id="officerName" readonly>
          </div>
        </div>

        <!-- WAREHOUSE -->
        <div class="grid">
          <div>
            <label>Warehouse ID</label>
            <input type="text" id="warehouseId" readonly>
          </div>
          <div>
            <label>Warehouse Name</label>
            <input type="text" id="warehouseName" readonly>
          </div>
        </div>

        <!-- PERIOD -->
        <div class="grid">
          <div>
            <label>Period From</label>
            <input type="date" id="periodFrom" readonly>
          </div>
          <div>
            <label>Period To</label>
            <input type="date" id="periodTo" readonly>
          </div>
        </div>

        <hr>

        <h3>Transaction Details</h3>

        <!-- DOC NO + CANCELLED -->
        <div class="grid">
          <div>
            <label>Document No.</label>
            <input type="text">
          </div>
          <div class="checkbox-align">
            <label>
              <input type="checkbox"> Cancelled
            </label>
          </div>
        </div>

        <!-- DOC TYPE + OR NO -->
        <div class="grid">
          <div>
            <label>Document Type</label>
            <select>
              <option value="">Select</option>
              <option>RIS</option>
              <option>DR</option>
              <option>WSI</option>
              <option>Invoice</option>
            </select>
          </div>
          <div>
            <label>OR No.</label>
            <input type="text">
          </div>
        </div>

        <!-- AI NO + REF WSI -->
        <div class="grid">
          <div>
            <label>AI No.</label>
            <input type="text">
          </div>
          <div>
            <label>Ref. WSI No.</label>
            <input type="text">
          </div>
        </div>

        <!-- RECD / ISSD + DATE -->
        <div class="grid">
          <div>
            <label>Recd From / Issd To</label>
            <input type="text">
          </div>
          <div>
            <label>Transaction Date</label>
            <input type="date">
          </div>
        </div>

        <!-- ACTIVITY + VARIETY -->
        <div class="grid">
          <div>
            <label>Activity Code</label>
            <input type="text">
          </div>
          <div>
            <label>Variety Code</label>
            <input type="text">
          </div>
        </div>

        <!-- SACK CODE + CONDITION + SACK WEIGHT -->
        <div class="grid-3">
          <div>
            <label>Sack Code</label>
            <input type="text">
          </div>
          <div>
            <label>Sack Condition</label>
            <select>
              <option value="">Select</option>
              <option>Good</option>
              <option>Damaged</option>
            </select>
          </div>
          <div>
            <label>Sack Weight</label>
            <input type="number" id="sackWeight">
          </div>
        </div>

        <!-- AGE + PILE NO -->
        <div class="grid-3">
          <div>
            <label>Age</label>
            <input type="number">
          </div>
          <div>
            <label>Pile No.</label>
            <input type="number">
          </div>
        </div>

        <!-- BAGS + GROSS + MC -->
        <div class="grid-3">
          <div>
            <label>No. of Bags</label>
            <input type="number">
          </div>
          <div>
            <label>Gross Weight</label>
            <input type="number" id="grossWeight">
          </div>
          <div>
            <label>% MC</label>
            <input type="number">
          </div>
        </div>

        <!-- NET WEIGHT -->
        <div class="grid">
          <div>
            <label>Net Weight</label>
            <input type="number" id="netWeight" readonly>
          </div>
        </div>

        <button type="submit">Save Transaction</button>
      </form>
    </div>
  </div>

  <!-- MAIN -->
  <main class="main">
    <section class="inventory-section">
      <div class="section-header">
        <h2>Transaction</h2>
        <button class="add-btn" id="addTransaction">+ Add Transaction</button>
      </div>
    </section>
  </main>

</div>

<script>
/* LOAD SIDEBAR */
fetch("sidebar.html")
  .then(r => r.text())
  .then(html => {
    sidebar.innerHTML = html;
    goHome.onclick = () => location.href="homepage.html";
    goAcc.onclick = () => location.href="accountable.html";
    goTrans.onclick = () => location.href="transaction.html";
  });

const officerModal = document.getElementById("officerModal");
const transactionModal = document.getElementById("transactionModal");

/* STEP 1: OPEN OFFICER TABLE */
document.getElementById("addTransaction").onclick = () => {
  officerModal.style.display = "block";
};

/* CLOSE MODALS */
document.getElementById("closeOfficer").onclick = () => officerModal.style.display = "none";
document.getElementById("closeTransaction").onclick = () => transactionModal.style.display = "none";

/* STEP 2: SELECT OFFICER */
document.querySelectorAll(".selectOfficer").forEach(btn => {
  btn.addEventListener("click", function () {
    const row = this.closest("tr");

    // Set Officer info
    document.getElementById("officerId").value = row.children[0].textContent;
    document.getElementById("officerName").value =
      row.children[1].textContent + ", " + row.children[2].textContent + " " + row.children[3].textContent;

    // Set Warehouse info
    document.getElementById("warehouseId").value = row.children[4].textContent;
    document.getElementById("warehouseName").value = row.children[5].textContent;

    // Set Period
    const period = row.children[6].textContent.split(" / ");
    document.getElementById("periodFrom").value = period[0];
    document.getElementById("periodTo").value = period[1];

    // Close Officer modal and open Transaction modal
    officerModal.style.display = "none";
    transactionModal.style.display = "block";
  });
});

/* SAVE TRANSACTION */
document.getElementById("transactionForm").onsubmit = e => {
  e.preventDefault();
  alert("Transaction saved.");
  transactionModal.style.display = "none";
  e.target.reset();
};

/* NET WEIGHT COMPUTATION */
const gross = document.getElementById("grossWeight");
const sack = document.getElementById("sackWeight");
const net = document.getElementById("netWeight");

function computeNetWeight() {
  const g = parseFloat(gross.value) || 0;
  const s = parseFloat(sack.value) || 0;
  net.value = g - s;
}

gross.addEventListener("input", computeNetWeight);
sack.addEventListener("input", computeNetWeight);

</script>

</body>
</html>
